.. highlight:: xml

Reservation
===========

|

Method Goals
------------

This method aims to book an option.

|

Request Format
--------------

The request format works the same way as the *Valuation* request but
with the list of passengers.

|

Response Format
---------------

The result returns the booking locator (booking code). It can be the
provider's or the one sent in the request.

|

It also returns all the charges associated to the booking and the
state of booking.

|

Remarks
-------

The maximum time, that is permitted in our system, before the connection is closed,  is of **180000** milliseconds.

|

ReservationRQ Example
---------------------

::

    <ReservationRQ>
        <ClientLocator>2537459</ClientLocator>
        <Parameters>
            <Parameter key = "extra" value = "31"/>
        </Parameters>
        <StartDate>28/01/2014</StartDate>
        <EndDate>29/01/2014</EndDate>
        <MealPlanCode>D</MealPlanCode>
        <HotelCode>10</HotelCode>
        <Price currency = "EUR" amount = "36.20" binding = "false" commission = "-1"/>
        <ResGuests>
            <Guests>
                <Guest roomCandidateId = "1" paxId = "1">
                    <GivenName>Test11</GivenName>
                    <SurName>TestAp11</SurName>
                </Guest>
                <Guest roomCandidateId = "1" paxId = "2">
                    <GivenName>Test12</GivenName>
                    <SurName>TestAp12</SurName>
                </Guest>
            </Guests>
        </ResGuests>
        <PaymentType>MenchardPay</PaymentType>
        <Rooms>
            <Room id = "4582" roomCandidateRefId = "1" code = "506" description = "Double Standard.."/>
        </Rooms>
        <RoomCandidates>
            <RoomCandidate id = "1">
                <Paxes>
                    <Pax age = "30" id = "1"/>
                    <Pax age = "30" id = "2"/>
                </Paxes>
            </RoomCandidate>
        </RoomCandidates>
    </ReservationRQ>

|

ReservationRQ Description
-------------------------

+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Element                                  | Number   | Type      | Description                                                                                                                                              |
+==========================================+==========+===========+==========================================================================================================================================================+
| ReservationRQ                            | 1        |           | Root node.                                                                                                                                               |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ClientLocator                            | 1        | String    | Client locator.                                                                                                                                          |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Parameters                               | 0..1     |           | Parameters for additional information that have been reported in ValuationRS.                                                                            |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Parameters/Parameter                     | 1..n     |           | List of parameter.                                                                                                                                       |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@key*                                   | 1        | String    | Contains the keyword/Id to identify a parameter.                                                                                                         |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@value*                                 | 1        | String    | Contains the value of the parameter                                                                                                                      |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| StartDate                                | 1        | String    | Start date to search rates.                                                                                                                              |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| EndDate                                  | 1        | String    | End date to search rates.                                                                                                                                |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| MealPlanCode                             | 1        | String    | MealPlan code.                                                                                                                                           |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| HotelCode                                | 1        | String    | Hotel code.                                                                                                                                              |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| PaymentType                              | 1        | String    | Indicates the typology of payment.                                                                                                                       |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Price                                    | 1        |           | Total price of this valuation.                                                                                                                           |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@currency*                              | 1        | String    | Currency code.                                                                                                                                           |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@amount*                                | 1        | Decimal   | Option Amount.                                                                                                                                           |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@binding*                               | 1        | Boolean   | Identifies if is the price is binding ( When true the sale price returned **must** not be less than the price informed.                                  |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@commission*                            | 1        | Decimal   | Commission ( -1 = not specified (will come indicated with the provider contract ), 0 = net price, X = % of the commission that applies to the amount .   |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ResGuests                                | 1        |           | Structure of the passengers.                                                                                                                             |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ResGuests/Guests                         | 1        |           | List of passengers.                                                                                                                                      |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ResGuests/Guests/Guest                   | 1..n     |           | Detail of each passenger.                                                                                                                                |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@roomCandidateId*                       | 1        | Integer   | Identifier of room candidate.                                                                                                                            |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@paxId*                                 | 1        | Integer   | Passenger id (starting at 1).                                                                                                                            |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ResGuests/Guests/Guest/GivenName         | 1        | String    | Given name.                                                                                                                                              |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ResGuests/Guests/Guest/SurName           | 1        | String    | Surname.                                                                                                                                                 |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Rooms                                    | 1        |           | Rooms of this option ( room list).                                                                                                                       |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Rooms/Room                               | 1..n     |           | Detail of room.                                                                                                                                          |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@id*                                    | 1        | String    | Identifier of the room.                                                                                                                                  |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@roomCandidateRefId*                    | 1        | Integer   | Identifier of room candidate.                                                                                                                            |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@code*                                  | 1        | String    | Room code.                                                                                                                                               |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@description*                           | 1        | String    | Room description.                                                                                                                                        |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| RoomCandidates/RoomCandidate             | 1..n     |           | Room required.                                                                                                                                           |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@id*                                    | 1        | Integer   | Id of the requested room (starting at 1).                                                                                                                |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| RoomCandidates/RoomCandidate/Paxes/Pax   | 1..n     |           | Pax required.                                                                                                                                            |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@age*                                   | 1        | Integer   | Passenger age.                                                                                                                                           |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@id*                                    | 1        | Integer   | Passenger id (starting at 1).                                                                                                                            |
+------------------------------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+

|

ReservationRS Example
---------------------

::

    <ReservationRS>
        <ProviderLocator>102</ProviderLocator>
        <ResStatus>OK</ResStatus>
        <Price currency = "EUR" amount = "36.20" binding = "false" commission = "-1"/>
    </ReservationRS>

|

ReservationRS Description
-------------------------

+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Element           | Number   | Type      | Description                                                                                                                                              |
+===================+==========+===========+==========================================================================================================================================================+
| ReservationRS     | 1        |           | Root node.                                                                                                                                               |
+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ProviderLocator   | 1        | String    | Provider locator                                                                                                                                         |
+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ResStatus         | 1        | String    | Status of book (OK = confirmed, RQ = on request, CN = cancelled, UN = unknown                                                                             |
+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Price             | 0..1     |           | Total price of this book.                                                                                                                                |
+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@currency*       | 1        | String    | Currency code.                                                                                                                                           |
+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@amount*         | 1        | Decimal   | Book Amount.                                                                                                                                             |
+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@binding*        | 1        | Boolean   | Identifies if is the price is binding ( When true the sale price returned **must** not be less than the price informed.                                  |
+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| *@commission*     | 1        | Decimal   | Commission ( -1 = not specified (will come indicated with the provider contract ), 0 = net price, X = % of the commission that applies to the amount .   |
+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Remarks           | 0..1     | String    | Remarks of this book.                                                                                                                                    |
+-------------------+----------+-----------+----------------------------------------------------------------------------------------------------------------------------------------------------------+

|

Detailed description 
---------------------

**ResStatus:**

When doing a reservation, in the response, there will be a field named ResStatus which will indicate the status of the reservation. 
The status of the reservation can have fours values: OK, RQ, CN and UN.

* *OK:* The reservation finished with no problems.

* *RQ:* The reservation is finished but the product is still not available, so it will set the reservation in a waiting list  ( Request ).

* *CN:* The reservation is finished but a provider error or a timeout occurred, then for some providers, the system will immediately cancel the reservation to prevent possible errors. 

* *UN:* The reservation is finished but a provider error or a timeout occurred and we can't assure 100% that the status of the reservation is in a OK status, therefore it is the clients responsibility to check if the reservation fulfilled completely.

|

.. note:: Keep the parameters in the valuation response to include them in the reservation request.